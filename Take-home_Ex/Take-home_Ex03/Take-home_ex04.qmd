---
title: "Take-home_Ex10"
author: "Yuheng Liang"
format: html
editor: visual
date: "Oct 28, 2024"
date-modified: "Oct 28, 2024"
execute: 
  eval: true
  echo: true
  freeze: true
---

# Take home exe 03

## Data

-   Philippines data from [Armed Conflict Location & Event Data Project (ACLED)](https://acleddata.com/).

-   [Philippines boundary data](https://data.humdata.org/dataset/cod-ab-phl) from HDX

## Importing data and package

### package

-   spNetwork, which provides functions to perform Spatial Point Patterns Analysis such as kernel density estimation (KDE) and K-function on network. It also can be used to build spatial matrices (‘listw’ objects like in ‘spdep’ package) to conduct any kind of traditional spatial analysis with spatial weights based on reticular distances.
-   sf package provides functions to manage, processing, and manipulate Simple Features, a formal geospatial data standard that specifies a storage and access model of spatial geometries such as points, lines, and polygons.
-   tmap which provides functions for plotting cartographic quality static point patterns maps or interactive maps by using leaflet API.
-   spatstat, which has a wide range of useful functions for point pattern analysis. In this hands-on exercise, it will be used to perform 1st- and 2nd-order spatial point patterns analysis and derive kernel density estimation (KDE) layer.
-   raster which reads, writes, manipulates, analyses and model of gridded spatial data (i.e. raster). In this hands-on exercise, it will be used to convert image output generate by spatstat into raster format.
-   maptools which provides a set of tools for manipulating geographic data. In this hands-on exercise, we mainly use it to convert Spatial objects into ppp format of spatstat.

```{r}
pacman::p_load(sf, raster, spatstat, tmap, tidyverse,sparr,spNetwork,dplyr,animation,stringr)
```

### data

```{r}
drug_case <- read_csv("data/2016-01-01-2024-06-30-Philippines.csv")%>%
    st_as_sf(coords = c("longitude", "latitude"), crs = 4326) %>%
    st_transform(crs = 32651) %>%
  mutate(event_date = dmy(event_date)) %>%
  mutate(event_month = year*100 + month(event_date)) %>%
  mutate(event_quarter = year*10 + quarter(event_date))%>%
  mutate(quarter = as.numeric(str_sub(event_quarter, 5, 5)))
```

```{r}
write_csv(drug_case,"data/drug_case.csv")
```

import the boundary data

```{r}
ph_sf = st_read(dsn = "data/phl_adm_psa_namria_20231106_shp",layer = "phl_admbnda_adm2_psa_namria_20231106")
```

chack the crs

```{r}
st_crs(ph_sf)
```

transform the crs

```{r}
ph_sf = st_transform(ph_sf,crs = 32651)
st_crs(ph_sf)
```

```{r}
ph_sf_owin <-as.owin(ph_sf)
```

show the point

```{r}
tmap_mode('view')
tm_shape(drug_case)+tm_dots()
```

```{r}
tmap_mode('plot')
```

```{r}
hist(drug_case$year)
hist(drug_case$event_month)
```

```{r}
drug_case$fatalities <- as.numeric(drug_case$fatalities)

fatalities_by_year <- drug_case %>%
  group_by(year) %>%
  summarise(
    total_fatalities = sum(fatalities, na.rm = TRUE),
    average_fatalities = mean(fatalities, na.rm = TRUE),
    .groups = "drop"
  )

print(fatalities_by_year)
```

```{r}
# 按月份分组并统计每个月的案件数量
cases_by_month <- drug_case %>%
  group_by(event_month) %>%
  summarise(case_count = n()) %>%
  arrange(event_month)

# 打印结果
print(cases_by_month)
```

```{r}

cases_by_quarter <- drug_case %>%
  group_by(event_quarter) %>%
  summarise(case_count = n()) %>%
  arrange(event_quarter)

print(cases_by_quarter)
```

```{r}
ggplot(cases_by_month, aes(x = event_month, y = case_count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "case_month", x = "month", y = "num") +
  theme_minimal()

ggplot(cases_by_quarter, aes(x = event_quarter, y = case_count)) +
  geom_bar(stat = "identity", fill = "lightgreen") +
  labs(title = "case by q", x = "q", y = "num") +
  theme_minimal()

```

### data warning

根据event type和disorder type分理出各个不同种类的数据

```{r}
Violence_against_civilians <- drug_case%>%
  filter(event_type == "Violence against civilians")
Strategic_developments <- drug_case%>%
  filter(event_type == "Strategic developments")
Battles <- drug_case%>%
  filter(event_type == "Battles")
Political_violence <- drug_case%>%
  filter(disorder_type == "Political violence")
Strategic_developments <- drug_case%>%
  filter(disorder_type == "Strategic developments")
```

####按照年分类好数据 \##### 总的所有数据

```{r}
drug_case_2016_q1 <- drug_case %>%
  filter(year== 2016,event_quarter == 20161)
drug_case_2016_q2 <- drug_case %>%
  filter(year== 2016,event_quarter == 20162)
drug_case_2016_q3 <- drug_case %>%
  filter(year== 2016,event_quarter == 20163)
drug_case_2016_q4 <- drug_case %>%
  filter(year== 2016,event_quarter == 20164)
drug_case_2017_q1 <- drug_case %>%
  filter(year== 2017,event_quarter == 20171)
drug_case_2017_q2 <- drug_case %>%
  filter(year== 2017,event_quarter == 20172)
drug_case_2017_q3 <- drug_case %>%
  filter(year== 2017,event_quarter == 20173)
drug_case_2017_q4 <- drug_case %>%
  filter(year== 2017,event_quarter == 20174)
drug_case_2018_q1 <- drug_case %>%
  filter(year== 2018,event_quarter == 20181)
drug_case_2018_q2 <- drug_case %>%
  filter(year== 2018,event_quarter == 20182)
drug_case_2018_q3 <- drug_case %>%
  filter(year== 2018,event_quarter == 20183)
drug_case_2018_q4 <- drug_case %>%
  filter(year== 2018,event_quarter == 20184)
drug_case_2019_q1 <- drug_case %>%
  filter(year== 2019,event_quarter == 20191)
drug_case_2019_q2 <- drug_case %>%
  filter(year== 2019,event_quarter == 20192)
drug_case_2019_q3 <- drug_case %>%
  filter(year== 2019,event_quarter == 20193)
drug_case_2019_q4 <- drug_case %>%
  filter(year== 2019,event_quarter == 20194)
drug_case_2020_q1 <- drug_case %>%
  filter(year== 2020,event_quarter == 20201)
drug_case_2020_q2 <- drug_case %>%
  filter(year== 2020,event_quarter == 20202)
drug_case_2020_q3 <- drug_case %>%
  filter(year== 2020,event_quarter == 20203)
drug_case_2020_q4 <- drug_case %>%
  filter(year== 2020,event_quarter == 20204)
drug_case_2021_q1 <- drug_case %>%
  filter(year== 2021,event_quarter == 20211)
drug_case_2021_q2 <- drug_case %>%
  filter(year== 2021,event_quarter == 20212)
drug_case_2021_q3 <- drug_case %>%
  filter(year== 2021,event_quarter == 20213)
drug_case_2021_q4 <- drug_case %>%
  filter(year== 2021,event_quarter == 20214)
drug_case_2022_q1 <- drug_case%>%
  filter(year== 2022,event_quarter == 20221)
drug_case_2022_q2 <- drug_case%>%
  filter(year== 2022,event_quarter == 20222)
drug_case_2022_q3 <- drug_case%>%
  filter(year== 2022,event_quarter == 20223)
drug_case_2022_q4 <- drug_case%>%
  filter(year== 2022,event_quarter == 20224)
drug_case_2023_q1 <- drug_case%>%
  filter(year== 2023,event_quarter == 20231)
drug_case_2023_q2 <- drug_case%>%
  filter(year== 2023,event_quarter == 20232)
drug_case_2023_q3 <- drug_case%>%
  filter(year== 2023,event_quarter == 20233)
drug_case_2023_q4 <- drug_case%>%
  filter(year== 2023,event_quarter == 20234)
drug_case_2024_q1 <- drug_case%>%
  filter(year== 2024,event_quarter == 20241)
drug_case_2024_q2 <- drug_case%>%
  filter(year== 2024,event_quarter == 20242)
```

#####Violence_against_civilians分类：

```{r}
Violence_16 = Violence_against_civilians %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Violence_17 = Violence_against_civilians %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Violence_18 = Violence_against_civilians %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Violence_19 = Violence_against_civilians %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Violence_20 = Violence_against_civilians %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Violence_21 = Violence_against_civilians %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Violence_22 = Violence_against_civilians %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Violence_23 = Violence_against_civilians %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Violence_24 = Violence_against_civilians %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
```

```{r}
create_violence_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Violence against civilians", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Violence_16_q1 <- create_violence_ppp(drug_case, 2016, 1)
Violence_16_q2 <- create_violence_ppp(drug_case, 2016, 2)
Violence_16_q3 <- create_violence_ppp(drug_case, 2016, 3)
Violence_16_q4 <- create_violence_ppp(drug_case, 2016, 4)
Violence_17_q1 <- create_violence_ppp(drug_case, 2017, 1)
Violence_17_q2 <- create_violence_ppp(drug_case, 2017, 2)
Violence_17_q3 <- create_violence_ppp(drug_case, 2017, 3)
Violence_17_q4 <- create_violence_ppp(drug_case, 2017, 4)
Violence_18_q1 <- create_violence_ppp(drug_case, 2018, 1)
Violence_18_q2 <- create_violence_ppp(drug_case, 2018, 2)
Violence_18_q3 <- create_violence_ppp(drug_case, 2018, 3)
Violence_18_q4 <- create_violence_ppp(drug_case, 2018, 4)
Violence_19_q1 <- create_violence_ppp(drug_case, 2019, 1)
Violence_19_q2 <- create_violence_ppp(drug_case, 2019, 2)
Violence_19_q3 <- create_violence_ppp(drug_case, 2019, 3)
Violence_19_q4 <- create_violence_ppp(drug_case, 2019, 4)
Violence_20_q1 <- create_violence_ppp(drug_case, 2020, 1)
Violence_20_q2 <- create_violence_ppp(drug_case, 2020, 2)
Violence_20_q3 <- create_violence_ppp(drug_case, 2020, 3)
Violence_20_q4 <- create_violence_ppp(drug_case, 2020, 4)
Violence_21_q1 <- create_violence_ppp(drug_case, 2021, 1)
Violence_21_q2 <- create_violence_ppp(drug_case, 2021, 2)
Violence_21_q3 <- create_violence_ppp(drug_case, 2021, 3)
Violence_21_q4 <- create_violence_ppp(drug_case, 2021, 4)
Violence_22_q1 <- create_violence_ppp(drug_case, 2022, 1)
Violence_22_q2 <- create_violence_ppp(drug_case, 2022, 2)
Violence_22_q3 <- create_violence_ppp(drug_case, 2022, 3)
Violence_22_q4 <- create_violence_ppp(drug_case, 2022, 4)
Violence_23_q1 <- create_violence_ppp(drug_case, 2023, 1)
Violence_23_q2 <- create_violence_ppp(drug_case, 2023, 2)
Violence_23_q3 <- create_violence_ppp(drug_case, 2023, 3)
Violence_23_q4 <- create_violence_ppp(drug_case, 2023, 4)
Violence_24_q1 <- create_violence_ppp(drug_case, 2024, 1)
Violence_24_q2 <- create_violence_ppp(drug_case, 2024, 2)
```

##### Strategic_developments数据分类：

```{r}
Strategic_16 = Strategic_developments %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Strategic_17 = Strategic_developments %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Strategic_18 = Strategic_developments %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Strategic_19 = Strategic_developments %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Strategic_20 = Strategic_developments %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Strategic_21 = Strategic_developments %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Strategic_22 = Strategic_developments %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Strategic_23 = Strategic_developments %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Strategic_24 = Strategic_developments %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
```

再按季分类

```{r}
create_Strategic_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Strategic developments", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Strategic_16_q1 <- create_Strategic_ppp(drug_case, 2016, 1)
Strategic_16_q2 <- create_Strategic_ppp(drug_case, 2016, 2)
Strategic_16_q3 <- create_Strategic_ppp(drug_case, 2016, 3)
Strategic_16_q4 <- create_Strategic_ppp(drug_case, 2016, 4)
Strategic_17_q1 <- create_Strategic_ppp(drug_case, 2017, 1)
Strategic_17_q2 <- create_Strategic_ppp(drug_case, 2017, 2)
Strategic_17_q3 <- create_Strategic_ppp(drug_case, 2017, 3)
Strategic_17_q4 <- create_Strategic_ppp(drug_case, 2017, 4)
Strategic_18_q1 <- create_Strategic_ppp(drug_case, 2018, 1)
Strategic_18_q2 <- create_Strategic_ppp(drug_case, 2018, 2)
Strategic_18_q3 <- create_Strategic_ppp(drug_case, 2018, 3)
Strategic_18_q4 <- create_Strategic_ppp(drug_case, 2018, 4)
Strategic_19_q1 <- create_Strategic_ppp(drug_case, 2019, 1)
Strategic_19_q2 <- create_Strategic_ppp(drug_case, 2019, 2)
Strategic_19_q3 <- create_Strategic_ppp(drug_case, 2019, 3)
Strategic_19_q4 <- create_Strategic_ppp(drug_case, 2019, 4)
Strategic_20_q1 <- create_Strategic_ppp(drug_case, 2020, 1)
Strategic_20_q2 <- create_Strategic_ppp(drug_case, 2020, 2)
Strategic_20_q3 <- create_Strategic_ppp(drug_case, 2020, 3)
Strategic_20_q4 <- create_Strategic_ppp(drug_case, 2020, 4)
Strategic_21_q1 <- create_Strategic_ppp(drug_case, 2021, 1)
Strategic_21_q2 <- create_Strategic_ppp(drug_case, 2021, 2)
Strategic_21_q3 <- create_Strategic_ppp(drug_case, 2021, 3)
Strategic_21_q4 <- create_Strategic_ppp(drug_case, 2021, 4)
Strategic_22_q1 <- create_Strategic_ppp(drug_case, 2022, 1)
Strategic_22_q2 <- create_Strategic_ppp(drug_case, 2022, 2)
Strategic_22_q3 <- create_Strategic_ppp(drug_case, 2022, 3)
Strategic_22_q4 <- create_Strategic_ppp(drug_case, 2022, 4)
Strategic_23_q1 <- create_Strategic_ppp(drug_case, 2023, 1)
Strategic_23_q2 <- create_Strategic_ppp(drug_case, 2023, 2)
Strategic_23_q3 <- create_Strategic_ppp(drug_case, 2023, 3)
Strategic_23_q4 <- create_Strategic_ppp(drug_case, 2023, 4)
Strategic_24_q1 <- create_Strategic_ppp(drug_case, 2024, 1)
Strategic_24_q2 <- create_Strategic_ppp(drug_case, 2024, 2)
```

##### battles的数据分类

```{r}
Battles_16 = Battles %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Battles_17 = Battles %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Battles_18 = Battles %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Battles_19 = Battles %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Battles_20 = Battles %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Battles_21 = Battles %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Battles_22 = Battles %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Battles_23 = Battles %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Battles_24 = Battles %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
```

在按照季节分类

```{r}
create_battles_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Battles", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
battles_16_q1 <- create_battles_ppp(drug_case, 2016, 1)
battles_16_q2 <- create_battles_ppp(drug_case, 2016, 2)
battles_16_q3 <- create_battles_ppp(drug_case, 2016, 3)
battles_16_q4 <- create_battles_ppp(drug_case, 2016, 4)
battles_17_q1 <- create_battles_ppp(drug_case, 2017, 1)
battles_17_q2 <- create_battles_ppp(drug_case, 2017, 2)
battles_17_q3 <- create_battles_ppp(drug_case, 2017, 3)
battles_17_q4 <- create_battles_ppp(drug_case, 2017, 4)
battles_18_q1 <- create_battles_ppp(drug_case, 2018, 1)
battles_18_q2 <- create_battles_ppp(drug_case, 2018, 2)
battles_18_q3 <- create_battles_ppp(drug_case, 2018, 3)
battles_18_q4 <- create_battles_ppp(drug_case, 2018, 4)
battles_19_q1 <- create_battles_ppp(drug_case, 2019, 1)
battles_19_q2 <- create_battles_ppp(drug_case, 2019, 2)
battles_19_q3 <- create_battles_ppp(drug_case, 2019, 3)
battles_19_q4 <- create_battles_ppp(drug_case, 2019, 4)
battles_20_q1 <- create_battles_ppp(drug_case, 2020, 1)
battles_20_q2 <- create_battles_ppp(drug_case, 2020, 2)
battles_20_q3 <- create_battles_ppp(drug_case, 2020, 3)
battles_20_q4 <- create_battles_ppp(drug_case, 2020, 4)
battles_21_q1 <- create_battles_ppp(drug_case, 2021, 1)
battles_21_q2 <- create_battles_ppp(drug_case, 2021, 2)
battles_21_q3 <- create_battles_ppp(drug_case, 2021, 3)
battles_21_q4 <- create_battles_ppp(drug_case, 2021, 4)
battles_22_q1 <- create_battles_ppp(drug_case, 2022, 1)
battles_22_q2 <- create_battles_ppp(drug_case, 2022, 2)
battles_22_q3 <- create_battles_ppp(drug_case, 2022, 3)
battles_22_q4 <- create_battles_ppp(drug_case, 2022, 4)
battles_23_q1 <- create_battles_ppp(drug_case, 2023, 1)
battles_23_q2 <- create_battles_ppp(drug_case, 2023, 2)
battles_23_q3 <- create_battles_ppp(drug_case, 2023, 3)
battles_23_q4 <- create_battles_ppp(drug_case, 2023, 4)
battles_24_q1 <- create_battles_ppp(drug_case, 2024, 1)
battles_24_q2 <- create_battles_ppp(drug_case, 2024, 2)
```

##### Political violence

```{r}
Political_violence_16 = Political_violence %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Political_violence_17 = Political_violence %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Political_violence_18 = Political_violence %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Political_violence_19 = Political_violence %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Political_violence_20 = Political_violence %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Political_violence_21 = Political_violence %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Political_violence_22 = Political_violence %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Political_violence_23 = Political_violence %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Political_violence_24 = Political_violence %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
```

在按照季节分类

```{r}
create_Political_ppp <- function(data, year, quarter) {
  data %>%
    filter(disorder_type == "Political violence", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Political_16_q1 <- create_Political_ppp(drug_case, 2016, 1)
Political_16_q2 <- create_Political_ppp(drug_case, 2016, 2)
Political_16_q3 <- create_Political_ppp(drug_case, 2016, 3)
Political_16_q4 <- create_Political_ppp(drug_case, 2016, 4)
Political_17_q1 <- create_Political_ppp(drug_case, 2017, 1)
Political_17_q2 <- create_Political_ppp(drug_case, 2017, 2)
Political_17_q3 <- create_Political_ppp(drug_case, 2017, 3)
Political_17_q4 <- create_Political_ppp(drug_case, 2017, 4)
Political_18_q1 <- create_Political_ppp(drug_case, 2018, 1)
Political_18_q2 <- create_Political_ppp(drug_case, 2018, 2)
Political_18_q3 <- create_Political_ppp(drug_case, 2018, 3)
Political_18_q4 <- create_Political_ppp(drug_case, 2018, 4)
Political_19_q1 <- create_Political_ppp(drug_case, 2019, 1)
Political_19_q2 <- create_Political_ppp(drug_case, 2019, 2)
Political_19_q3 <- create_Political_ppp(drug_case, 2019, 3)
Political_19_q4 <- create_Political_ppp(drug_case, 2019, 4)
Political_20_q1 <- create_Political_ppp(drug_case, 2020, 1)
Political_20_q2 <- create_Political_ppp(drug_case, 2020, 2)
Political_20_q3 <- create_Political_ppp(drug_case, 2020, 3)
Political_20_q4 <- create_Political_ppp(drug_case, 2020, 4)
Political_21_q1 <- create_Political_ppp(drug_case, 2021, 1)
Political_21_q2 <- create_Political_ppp(drug_case, 2021, 2)
Political_21_q3 <- create_Political_ppp(drug_case, 2021, 3)
Political_21_q4 <- create_Political_ppp(drug_case, 2021, 4)
Political_22_q1 <- create_Political_ppp(drug_case, 2022, 1)
Political_22_q2 <- create_Political_ppp(drug_case, 2022, 2)
Political_22_q3 <- create_Political_ppp(drug_case, 2022, 3)
Political_22_q4 <- create_Political_ppp(drug_case, 2022, 4)
Political_23_q1 <- create_Political_ppp(drug_case, 2023, 1)
Political_23_q2 <- create_Political_ppp(drug_case, 2023, 2)
Political_23_q3 <- create_Political_ppp(drug_case, 2023, 3)
Political_23_q4 <- create_Political_ppp(drug_case, 2023, 4)
Political_24_q1 <- create_Political_ppp(drug_case, 2024, 1)
Political_24_q2 <- create_Political_ppp(drug_case, 2024, 2)
```

##### Strategic developments

```{r}
Strategic_developments_16 = Strategic_developments %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Strategic_developments_17 = Strategic_developments %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Strategic_developments_18 = Strategic_developments %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Strategic_developments_19 = Strategic_developments %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Strategic_developments_20 = Strategic_developments %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Strategic_developments_21 = Strategic_developments %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Strategic_developments_22 = Strategic_developments %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Strategic_developments_23 = Strategic_developments %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Strategic_developments_24 = Strategic_developments %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
```

```{r}
create_Strategic_ppp <- function(data, year, quarter) {
  data %>%
    filter(disorder_type == "Strategicdevelopments", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Strategic_16_q1 <- create_Strategic_ppp(drug_case, 2016, 1)
Strategic_16_q2 <- create_Strategic_ppp(drug_case, 2016, 2)
Strategic_16_q3 <- create_Strategic_ppp(drug_case, 2016, 3)
Strategic_16_q4 <- create_Strategic_ppp(drug_case, 2016, 4)
Strategic_17_q1 <- create_Strategic_ppp(drug_case, 2017, 1)
Strategic_17_q2 <- create_Strategic_ppp(drug_case, 2017, 2)
Strategic_17_q3 <- create_Strategic_ppp(drug_case, 2017, 3)
Strategic_17_q4 <- create_Strategic_ppp(drug_case, 2017, 4)
Strategic_18_q1 <- create_Strategic_ppp(drug_case, 2018, 1)
Strategic_18_q2 <- create_Strategic_ppp(drug_case, 2018, 2)
Strategic_18_q3 <- create_Strategic_ppp(drug_case, 2018, 3)
Strategic_18_q4 <- create_Strategic_ppp(drug_case, 2018, 4)
Strategic_19_q1 <- create_Strategic_ppp(drug_case, 2019, 1)
Strategic_19_q2 <- create_Strategic_ppp(drug_case, 2019, 2)
Strategic_19_q3 <- create_Strategic_ppp(drug_case, 2019, 3)
Strategic_19_q4 <- create_Strategic_ppp(drug_case, 2019, 4)
Strategic_20_q1 <- create_Strategic_ppp(drug_case, 2020, 1)
Strategic_20_q2 <- create_Strategic_ppp(drug_case, 2020, 2)
Strategic_20_q3 <- create_Strategic_ppp(drug_case, 2020, 3)
Strategic_20_q4 <- create_Strategic_ppp(drug_case, 2020, 4)
Strategic_21_q1 <- create_Strategic_ppp(drug_case, 2021, 1)
Strategic_21_q2 <- create_Strategic_ppp(drug_case, 2021, 2)
Strategic_21_q3 <- create_Strategic_ppp(drug_case, 2021, 3)
Strategic_21_q4 <- create_Strategic_ppp(drug_case, 2021, 4)
Strategic_22_q1 <- create_Strategic_ppp(drug_case, 2022, 1)
Strategic_22_q2 <- create_Strategic_ppp(drug_case, 2022, 2)
Strategic_22_q3 <- create_Strategic_ppp(drug_case, 2022, 3)
Strategic_22_q4 <- create_Strategic_ppp(drug_case, 2022, 4)
Strategic_23_q1 <- create_Strategic_ppp(drug_case, 2023, 1)
Strategic_23_q2 <- create_Strategic_ppp(drug_case, 2023, 2)
Strategic_23_q3 <- create_Strategic_ppp(drug_case, 2023, 3)
Strategic_23_q4 <- create_Strategic_ppp(drug_case, 2023, 4)
Strategic_24_q1 <- create_Strategic_ppp(drug_case, 2024, 1)
Strategic_24_q2 <- create_Strategic_ppp(drug_case, 2024, 2)
```

Excluding the third and fourth quarters of 2016 and the first two or three quarters of 2017 and the first two or two quarters of 2021 the distribution of the other years is fairly even not described as seasonal

-   1 我应该基于那些点进行分析
-   2 先进行随机点的分析看菲律宾这些点是不是都是随机的
-   3 如果不是随机的那么哪里是案件发生比较高的地方
-   4 热点区域在多长时间内保持稳定？是否存在周期性的热点区域转移
-   5 是否存在事件上的关联（不同类型的事件上是否会发生转变） 分析：
-   1 时间趋势上的分析
-   2 不同时间类型在不同时间上的分析
-   3 空间热点上的分析

## 2nd Order Spatial Point Analysis

```{r}
drug_case_2016_ppp1 <- as.ppp(drug_case_2016_q1)
drug_case_2016_ppp2 <- as.ppp(drug_case_2016_q2)
drug_case_2016_ppp3 <- as.ppp(drug_case_2016_q3)
drug_case_2016_ppp4 <- as.ppp(drug_case_2016_q4)
```

```{r}
drug_case_2017_ppp1 <- as.ppp(drug_case_2017_q1)
drug_case_2017_ppp2 <- as.ppp(drug_case_2017_q2)
drug_case_2017_ppp3 <- as.ppp(drug_case_2017_q3)
drug_case_2017_ppp4 <- as.ppp(drug_case_2017_q4)
```

```{R}
drug_case_2018_ppp1 <- as.ppp(drug_case_2018_q1)
drug_case_2018_ppp2 <- as.ppp(drug_case_2018_q2)
drug_case_2018_ppp3 <- as.ppp(drug_case_2018_q3)
drug_case_2018_ppp4 <- as.ppp(drug_case_2018_q4)
```

```{r}
drug_case_2019_ppp1 <- as.ppp(drug_case_2019_q1)
drug_case_2019_ppp2 <- as.ppp(drug_case_2019_q2)
drug_case_2019_ppp3 <- as.ppp(drug_case_2019_q3)
drug_case_2019_ppp4 <- as.ppp(drug_case_2019_q4)
```

```{r}
drug_case_2020_ppp1 <- as.ppp(drug_case_2020_q1)
drug_case_2020_ppp2 <- as.ppp(drug_case_2020_q2)
drug_case_2020_ppp3 <- as.ppp(drug_case_2020_q3)
drug_case_2020_ppp4 <- as.ppp(drug_case_2020_q4)
```

```{R}
drug_case_2021_ppp1 <- as.ppp(drug_case_2021_q1)
drug_case_2021_ppp2 <- as.ppp(drug_case_2021_q2)
drug_case_2021_ppp3 <- as.ppp(drug_case_2021_q3)
drug_case_2021_ppp4 <- as.ppp(drug_case_2021_q4)
```

```{r}
drug_case_2022_ppp1 <- as.ppp(drug_case_2022_q1)
drug_case_2022_ppp2 <- as.ppp(drug_case_2022_q2)
drug_case_2022_ppp3 <- as.ppp(drug_case_2022_q3)
drug_case_2022_ppp4 <- as.ppp(drug_case_2022_q4)
```

```{r}
drug_case_2023_ppp1 <- as.ppp(drug_case_2023_q1)
drug_case_2023_ppp2 <- as.ppp(drug_case_2023_q2)
drug_case_2023_ppp3 <- as.ppp(drug_case_2023_q3)
drug_case_2023_ppp4 <- as.ppp(drug_case_2023_q4)
```

```{R}
drug_case_2024_ppp1 <- as.ppp(drug_case_2024_q1)
drug_case_2024_ppp2 <- as.ppp(drug_case_2024_q2)
```

```{r}
drug_case_2016_ppp1_owin <- drug_case_2016_ppp1[ph_sf_owin]
drug_case_2016_ppp2_owin <- drug_case_2016_ppp2[ph_sf_owin]
drug_case_2016_ppp3_owin <- drug_case_2016_ppp3[ph_sf_owin]
drug_case_2016_ppp4_owin <- drug_case_2016_ppp4[ph_sf_owin]
```

```{r}
drug_case_2017_ppp1_owin <- drug_case_2017_ppp1[ph_sf_owin]
drug_case_2017_ppp2_owin <- drug_case_2017_ppp2[ph_sf_owin]
drug_case_2017_ppp3_owin <- drug_case_2017_ppp3[ph_sf_owin]
drug_case_2017_ppp4_owin <- drug_case_2017_ppp4[ph_sf_owin]
```

```{R}
drug_case_2018_ppp1_owin <- drug_case_2018_ppp1[ph_sf_owin]
drug_case_2018_ppp2_owin <- drug_case_2018_ppp2[ph_sf_owin]
drug_case_2018_ppp3_owin <- drug_case_2018_ppp3[ph_sf_owin]
drug_case_2018_ppp4_owin <- drug_case_2018_ppp4[ph_sf_owin]
```

```{R}
drug_case_2019_ppp1_owin <- drug_case_2019_ppp1[ph_sf_owin]
drug_case_2019_ppp2_owin <- drug_case_2019_ppp2[ph_sf_owin]
drug_case_2019_ppp3_owin <- drug_case_2019_ppp3[ph_sf_owin]
drug_case_2019_ppp4_owin <- drug_case_2019_ppp4[ph_sf_owin]
```

```{r}
drug_case_2020_ppp1_owin <- drug_case_2020_ppp1[ph_sf_owin]
drug_case_2020_ppp2_owin <- drug_case_2020_ppp2[ph_sf_owin]
drug_case_2020_ppp3_owin <- drug_case_2020_ppp3[ph_sf_owin]
drug_case_2020_ppp4_owin <- drug_case_2020_ppp4[ph_sf_owin]
```

```{R}
drug_case_2021_ppp1_owin <- drug_case_2021_ppp1[ph_sf_owin]
drug_case_2021_ppp2_owin <- drug_case_2021_ppp2[ph_sf_owin]
drug_case_2021_ppp3_owin <- drug_case_2021_ppp3[ph_sf_owin]
drug_case_2021_ppp4_owin <- drug_case_2021_ppp4[ph_sf_owin]
```

```{R}
drug_case_2022_ppp1_owin <- drug_case_2022_ppp1[ph_sf_owin]
drug_case_2022_ppp2_owin <- drug_case_2022_ppp2[ph_sf_owin]
drug_case_2022_ppp3_owin <- drug_case_2022_ppp3[ph_sf_owin]
drug_case_2022_ppp4_owin <- drug_case_2022_ppp4[ph_sf_owin]
```

```{R}
drug_case_2023_ppp1_owin <- drug_case_2023_ppp1[ph_sf_owin]
drug_case_2023_ppp2_owin <- drug_case_2023_ppp2[ph_sf_owin]
drug_case_2023_ppp3_owin <- drug_case_2023_ppp3[ph_sf_owin]
drug_case_2023_ppp4_owin <- drug_case_2023_ppp4[ph_sf_owin]
```

```{r}
drug_case_2024_ppp1_owin <- drug_case_2024_ppp1[ph_sf_owin]
drug_case_2024_ppp2_owin <- drug_case_2024_ppp2[ph_sf_owin]
```

```{r}
drug_case_2016_ppp1.km <- rescale.ppp(drug_case_2016_ppp1_owin, 1000, "km")
drug_case_2016_ppp2.km <- rescale.ppp(drug_case_2016_ppp2_owin, 1000, "km")
drug_case_2016_ppp3.km <- rescale.ppp(drug_case_2016_ppp3_owin, 1000, "km")
drug_case_2016_ppp4.km <- rescale.ppp(drug_case_2016_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2017_ppp1.km <- rescale.ppp(drug_case_2017_ppp1_owin, 1000, "km")
drug_case_2017_ppp2.km <- rescale.ppp(drug_case_2017_ppp2_owin, 1000, "km")
drug_case_2017_ppp3.km <- rescale.ppp(drug_case_2017_ppp3_owin, 1000, "km")
drug_case_2017_ppp4.km <- rescale.ppp(drug_case_2017_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2018_ppp1.km <- rescale.ppp(drug_case_2018_ppp1_owin, 1000, "km")
drug_case_2018_ppp2.km <- rescale.ppp(drug_case_2018_ppp2_owin, 1000, "km")
drug_case_2018_ppp3.km <- rescale.ppp(drug_case_2018_ppp3_owin, 1000, "km")
drug_case_2018_ppp4.km <- rescale.ppp(drug_case_2018_ppp4_owin, 1000, "km")
```

```{R}
drug_case_2019_ppp1.km <- rescale.ppp(drug_case_2019_ppp1_owin, 1000, "km")
drug_case_2019_ppp2.km <- rescale.ppp(drug_case_2019_ppp2_owin, 1000, "km")
drug_case_2019_ppp3.km <- rescale.ppp(drug_case_2019_ppp3_owin, 1000, "km")
drug_case_2019_ppp4.km <- rescale.ppp(drug_case_2019_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2020_ppp1.km <- rescale.ppp(drug_case_2020_ppp1_owin, 1000, "km")
drug_case_2020_ppp2.km <- rescale.ppp(drug_case_2020_ppp2_owin, 1000, "km")
drug_case_2020_ppp3.km <- rescale.ppp(drug_case_2020_ppp3_owin, 1000, "km")
drug_case_2020_ppp4.km <- rescale.ppp(drug_case_2020_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2021_ppp1.km <- rescale.ppp(drug_case_2021_ppp1_owin, 1000, "km")
drug_case_2021_ppp2.km <- rescale.ppp(drug_case_2021_ppp2_owin, 1000, "km")
drug_case_2021_ppp3.km <- rescale.ppp(drug_case_2021_ppp3_owin, 1000, "km")
drug_case_2021_ppp4.km <- rescale.ppp(drug_case_2021_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2022_ppp1.km <- rescale.ppp(drug_case_2022_ppp1_owin, 1000, "km")
drug_case_2022_ppp2.km <- rescale.ppp(drug_case_2022_ppp2_owin, 1000, "km")
drug_case_2022_ppp3.km <- rescale.ppp(drug_case_2022_ppp3_owin, 1000, "km")
drug_case_2022_ppp4.km <- rescale.ppp(drug_case_2022_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2023_ppp1.km <- rescale.ppp(drug_case_2023_ppp1_owin, 1000, "km")
drug_case_2023_ppp2.km <- rescale.ppp(drug_case_2023_ppp2_owin, 1000, "km")
drug_case_2023_ppp3.km <- rescale.ppp(drug_case_2023_ppp3_owin, 1000, "km")
drug_case_2023_ppp4.km <- rescale.ppp(drug_case_2023_ppp4_owin, 1000, "km")
```

```{r}
drug_case_2024_ppp1.km <- rescale.ppp(drug_case_2024_ppp1_owin, 1000, "km")
drug_case_2024_ppp2.km <- rescale.ppp(drug_case_2024_ppp2_owin, 1000, "km")
```

```{r}
drug_case_2016_17_owin.csr <- envelope(drug_case_2016_17_owin.km, Gest, nsim = 99)
drug_case_2021_ppp_owin.csr <- envelope(drug_case_2021_ppp_owin.km,Gest,nsim = 99)
```

```{r}
plot(drug_case_2016_17_owin.csr)
plot(drug_case_2021_ppp_owin.csr)
```

## Computing Spatio-Temporal KDE Layer

```{r}
event_type_yearly_counts <- drug_case %>%
  group_by(event_quarter, event_type) %>%
  summarise(event_count = n(), .groups = "drop") %>%
  pivot_wider(names_from = event_type, values_from = event_count, values_fill = 0)

# print
print(event_type_yearly_counts)
```

now let us look at the events types individually for our Spatio-Temporal KDE

```{r}
# 提取年份和季度，并转换季度格式
Violence_against_civilians <- Violence_against_civilians %>%
  mutate(
    quarter = as.numeric(str_sub(event_quarter, 5, 5))
  )
Strategic_developments <- Strategic_developments %>%
  mutate(
    quarter = as.numeric(str_sub(event_quarter, 5, 5))
  )
Battles <- Battles %>%
  mutate(
    quarter = as.numeric(str_sub(event_quarter, 5, 5))
  )
Political_violence <- Political_violence %>%
  mutate(
    quarter = as.numeric(str_sub(event_quarter, 5, 5))
  )
Strategic_developments <- Strategic_developments %>%
  mutate(
    quarter = as.numeric(str_sub(event_quarter, 5, 5))
  )
```

### event type

#### Violence against civilians

```{r}
Violence_against_civilians_16 = Violence_against_civilians %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Violence_against_civilians_17 = Violence_against_civilians %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Violence_against_civilians_18 = Violence_against_civilians %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Violence_against_civilians_19 = Violence_against_civilians %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Violence_against_civilians_20 = Violence_against_civilians %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Violence_against_civilians_21 = Violence_against_civilians %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Violence_against_civilians_22 = Violence_against_civilians %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Violence_against_civilians_23 = Violence_against_civilians %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Violence_against_civilians_24 = Violence_against_civilians %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
Violence_against_civilians_16_ppp = as.ppp(Violence_against_civilians_16)
Violence_against_civilians_17_ppp = as.ppp(Violence_against_civilians_17)
Violence_against_civilians_18_ppp = as.ppp(Violence_against_civilians_18)
Violence_against_civilians_19_ppp = as.ppp(Violence_against_civilians_19)
Violence_against_civilians_20_ppp = as.ppp(Violence_against_civilians_20)
Violence_against_civilians_21_ppp = as.ppp(Violence_against_civilians_21)
Violence_against_civilians_22_ppp = as.ppp(Violence_against_civilians_22)
Violence_against_civilians_23_ppp = as.ppp(Violence_against_civilians_23)
Violence_against_civilians_24_ppp = as.ppp(Violence_against_civilians_24)
summary(Violence_against_civilians_16_ppp)
```

```{r}
Violence_against_civilians_16_owin = Violence_against_civilians_16_ppp[ph_sf_owin]
Violence_against_civilians_17_owin = Violence_against_civilians_17_ppp[ph_sf_owin]
Violence_against_civilians_18_owin = Violence_against_civilians_18_ppp[ph_sf_owin]
Violence_against_civilians_19_owin = Violence_against_civilians_19_ppp[ph_sf_owin]
Violence_against_civilians_20_owin = Violence_against_civilians_20_ppp[ph_sf_owin]
Violence_against_civilians_21_owin = Violence_against_civilians_21_ppp[ph_sf_owin]
Violence_against_civilians_22_owin = Violence_against_civilians_22_ppp[ph_sf_owin]
Violence_against_civilians_23_owin = Violence_against_civilians_23_ppp[ph_sf_owin]
Violence_against_civilians_24_owin = Violence_against_civilians_24_ppp[ph_sf_owin]
```

```{r}
Violence_against_civilians_16_st_kde= spattemp.density(Violence_against_civilians_16_owin)
Violence_against_civilians_17_st_kde= spattemp.density(Violence_against_civilians_17_owin)
Violence_against_civilians_18_st_kde= spattemp.density(Violence_against_civilians_18_owin)
Violence_against_civilians_19_st_kde= spattemp.density(Violence_against_civilians_19_owin)
Violence_against_civilians_20_st_kde= spattemp.density(Violence_against_civilians_20_owin)
Violence_against_civilians_21_st_kde= spattemp.density(Violence_against_civilians_21_owin)
Violence_against_civilians_22_st_kde= spattemp.density(Violence_against_civilians_22_owin)
Violence_against_civilians_23_st_kde= spattemp.density(Violence_against_civilians_23_owin)
Violence_against_civilians_24_st_kde= spattemp.density(Violence_against_civilians_24_owin)
```

```{r}
# set
par(mfrow = c(9, 4))
plot(Violence_against_civilians_16_st_kde)
plot(Violence_against_civilians_17_st_kde)
plot(Violence_against_civilians_18_st_kde)
plot(Violence_against_civilians_19_st_kde)
plot(Violence_against_civilians_20_st_kde)
plot(Violence_against_civilians_21_st_kde)
plot(Violence_against_civilians_22_st_kde)
plot(Violence_against_civilians_23_st_kde)
plot(Violence_against_civilians_24_st_kde)
```

#### Strategic_developments

```{r}
Strategic_developments_16 = Strategic_developments %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Strategic_developments_17 = Strategic_developments %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Strategic_developments_18 = Strategic_developments %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Strategic_developments_19 = Strategic_developments %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Strategic_developments_20 = Strategic_developments %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Strategic_developments_21 = Strategic_developments %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Strategic_developments_22 = Strategic_developments %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Strategic_developments_23 = Strategic_developments %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Strategic_developments_24 = Strategic_developments %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)

Strategic_developments_16_ppp = as.ppp(Strategic_developments_16)
Strategic_developments_17_ppp = as.ppp(Strategic_developments_17)
Strategic_developments_18_ppp = as.ppp(Strategic_developments_18)
Strategic_developments_19_ppp = as.ppp(Strategic_developments_19)
Strategic_developments_20_ppp = as.ppp(Strategic_developments_20)
Strategic_developments_21_ppp = as.ppp(Strategic_developments_21)
Strategic_developments_22_ppp = as.ppp(Strategic_developments_22)
Strategic_developments_23_ppp = as.ppp(Strategic_developments_23)
Strategic_developments_24_ppp = as.ppp(Strategic_developments_24)

summary(Strategic_developments_16_ppp)
```

```{r}
Strategic_developments_16_owin = Strategic_developments_16_ppp[ph_sf_owin]
Strategic_developments_17_owin = Strategic_developments_17_ppp[ph_sf_owin]
Strategic_developments_18_owin = Strategic_developments_18_ppp[ph_sf_owin]
Strategic_developments_19_owin = Strategic_developments_19_ppp[ph_sf_owin]
Strategic_developments_20_owin = Strategic_developments_20_ppp[ph_sf_owin]
Strategic_developments_21_owin = Strategic_developments_21_ppp[ph_sf_owin]
Strategic_developments_22_owin = Strategic_developments_22_ppp[ph_sf_owin]
Strategic_developments_23_owin = Strategic_developments_23_ppp[ph_sf_owin]
Strategic_developments_24_owin = Strategic_developments_24_ppp[ph_sf_owin]
```

```{r}
Strategic_developments_16_st_kde = spattemp.density(Strategic_developments_16_owin)
Strategic_developments_17_st_kde = spattemp.density(Strategic_developments_17_owin)
Strategic_developments_18_st_kde = spattemp.density(Strategic_developments_18_owin)
Strategic_developments_19_st_kde = spattemp.density(Strategic_developments_19_owin)
Strategic_developments_20_st_kde = spattemp.density(Strategic_developments_20_owin)
Strategic_developments_21_st_kde = spattemp.density(Strategic_developments_21_owin)
Strategic_developments_22_st_kde = spattemp.density(Strategic_developments_22_owin)
Strategic_developments_23_st_kde = spattemp.density(Strategic_developments_23_owin)
Strategic_developments_24_st_kde = spattemp.density(Strategic_developments_24_owin)
```

#### Battles

```{r}
Battles_16 = Battles %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Battles_17 = Battles %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Battles_18 = Battles %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Battles_19 = Battles %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Battles_20 = Battles %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Battles_21 = Battles %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Battles_22 = Battles %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Battles_23 = Battles %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Battles_24 = Battles %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
Battles_16_ppp = as.ppp(Battles_16)
Battles_17_ppp = as.ppp(Battles_17)
Battles_18_ppp = as.ppp(Battles_18)
Battles_19_ppp = as.ppp(Battles_19)
Battles_20_ppp = as.ppp(Battles_20)
Battles_21_ppp = as.ppp(Battles_21)
Battles_22_ppp = as.ppp(Battles_22)
Battles_23_ppp = as.ppp(Battles_23)
Battles_24_ppp = as.ppp(Battles_24)
summary(Battles_16_ppp)
```

```{R}
Battles_16_owin = Battles_16_ppp[ph_sf_owin]
Battles_17_owin = Battles_17_ppp[ph_sf_owin]
Battles_18_owin = Battles_18_ppp[ph_sf_owin]
Battles_19_owin = Battles_19_ppp[ph_sf_owin]
Battles_20_owin = Battles_20_ppp[ph_sf_owin]
Battles_21_owin = Battles_21_ppp[ph_sf_owin]
Battles_22_owin = Battles_22_ppp[ph_sf_owin]
Battles_23_owin = Battles_23_ppp[ph_sf_owin]
Battles_24_owin = Battles_24_ppp[ph_sf_owin]
```

### disorder type

#### Political violence

```{r}
Political_violence_16 = Political_violence %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Political_violence_17 = Political_violence %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Political_violence_18 = Political_violence %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Political_violence_19 = Political_violence %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Political_violence_20 = Political_violence %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Political_violence_21 = Political_violence %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Political_violence_22 = Political_violence %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Political_violence_23 = Political_violence %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Political_violence_24 = Political_violence %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)

Political_violence_16_ppp = as.ppp(Political_violence_16)
Political_violence_17_ppp = as.ppp(Political_violence_17)
Political_violence_18_ppp = as.ppp(Political_violence_18)
Political_violence_19_ppp = as.ppp(Political_violence_19)
Political_violence_20_ppp = as.ppp(Political_violence_20)
Political_violence_21_ppp = as.ppp(Political_violence_21)
Political_violence_22_ppp = as.ppp(Political_violence_22)
Political_violence_23_ppp = as.ppp(Political_violence_23)
Political_violence_24_ppp = as.ppp(Political_violence_24)
```

```{r}
Political_violence_16_owin = Political_violence_16_ppp[ph_sf_owin]
Political_violence_17_owin = Political_violence_17_ppp[ph_sf_owin]
Political_violence_18_owin = Political_violence_18_ppp[ph_sf_owin]
Political_violence_19_owin = Political_violence_19_ppp[ph_sf_owin]
Political_violence_20_owin = Political_violence_20_ppp[ph_sf_owin]
Political_violence_21_owin = Political_violence_21_ppp[ph_sf_owin]
Political_violence_22_owin = Political_violence_22_ppp[ph_sf_owin]
Political_violence_23_owin = Political_violence_23_ppp[ph_sf_owin]
Political_violence_24_owin = Political_violence_24_ppp[ph_sf_owin]
```

#### Strategic developments

```{r}
Strategic_developments_16 = Strategic_developments %>% 
  filter(year == 2016) %>% 
  dplyr::select(quarter)
Strategic_developments_17 = Strategic_developments %>% 
  filter(year == 2017) %>% 
  dplyr::select(quarter)
Strategic_developments_18 = Strategic_developments %>% 
  filter(year == 2018) %>% 
  dplyr::select(quarter)
Strategic_developments_19 = Strategic_developments %>% 
  filter(year == 2019) %>% 
  dplyr::select(quarter)
Strategic_developments_20 = Strategic_developments %>% 
  filter(year == 2020) %>% 
  dplyr::select(quarter)
Strategic_developments_21 = Strategic_developments %>% 
  filter(year == 2021) %>% 
  dplyr::select(quarter)
Strategic_developments_22 = Strategic_developments %>% 
  filter(year == 2022) %>% 
  dplyr::select(quarter)
Strategic_developments_23 = Strategic_developments %>% 
  filter(year == 2023) %>% 
  dplyr::select(quarter)
Strategic_developments_24 = Strategic_developments %>% 
  filter(year == 2024) %>% 
  dplyr::select(quarter)
Strategic_developments_16_ppp = as.ppp(Strategic_developments_16)
Strategic_developments_17_ppp = as.ppp(Strategic_developments_17)
Strategic_developments_18_ppp = as.ppp(Strategic_developments_18)
Strategic_developments_19_ppp = as.ppp(Strategic_developments_19)
Strategic_developments_20_ppp = as.ppp(Strategic_developments_20)
Strategic_developments_21_ppp = as.ppp(Strategic_developments_21)
Strategic_developments_22_ppp = as.ppp(Strategic_developments_22)
Strategic_developments_23_ppp = as.ppp(Strategic_developments_23)
Strategic_developments_24_ppp = as.ppp(Strategic_developments_24)
```

```{r}
Strategic_developments_16_owin = Strategic_developments_16_ppp[ph_sf_owin]
Strategic_developments_17_owin = Strategic_developments_17_ppp[ph_sf_owin]
Strategic_developments_18_owin = Strategic_developments_18_ppp[ph_sf_owin]
Strategic_developments_19_owin = Strategic_developments_19_ppp[ph_sf_owin]
Strategic_developments_20_owin = Strategic_developments_20_ppp[ph_sf_owin]
Strategic_developments_21_owin = Strategic_developments_21_ppp[ph_sf_owin]
Strategic_developments_22_owin = Strategic_developments_22_ppp[ph_sf_owin]
Strategic_developments_23_owin = Strategic_developments_23_ppp[ph_sf_owin]
Strategic_developments_24_owin = Strategic_developments_24_ppp[ph_sf_owin]
```

## 2nd Order Spatio-Temporal Point Pattern Analysis

### Violence against civilians

```{r}
create_violence_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Violence against civilians", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Violence_16_q1 <- create_violence_ppp(drug_case, 2016, 1)
Violence_16_q2 <- create_violence_ppp(drug_case, 2016, 2)
Violence_16_q3 <- create_violence_ppp(drug_case, 2016, 3)
Violence_16_q4 <- create_violence_ppp(drug_case, 2016, 4)
Violence_17_q1 <- create_violence_ppp(drug_case, 2017, 1)
Violence_17_q2 <- create_violence_ppp(drug_case, 2017, 2)
Violence_17_q3 <- create_violence_ppp(drug_case, 2017, 3)
Violence_17_q4 <- create_violence_ppp(drug_case, 2017, 4)
Violence_18_q1 <- create_violence_ppp(drug_case, 2018, 1)
Violence_18_q2 <- create_violence_ppp(drug_case, 2018, 2)
Violence_18_q3 <- create_violence_ppp(drug_case, 2018, 3)
Violence_18_q4 <- create_violence_ppp(drug_case, 2018, 4)
Violence_19_q1 <- create_violence_ppp(drug_case, 2019, 1)
Violence_19_q2 <- create_violence_ppp(drug_case, 2019, 2)
Violence_19_q3 <- create_violence_ppp(drug_case, 2019, 3)
Violence_19_q4 <- create_violence_ppp(drug_case, 2019, 4)
Violence_20_q1 <- create_violence_ppp(drug_case, 2020, 1)
Violence_20_q2 <- create_violence_ppp(drug_case, 2020, 2)
Violence_20_q3 <- create_violence_ppp(drug_case, 2020, 3)
Violence_20_q4 <- create_violence_ppp(drug_case, 2020, 4)
Violence_21_q1 <- create_violence_ppp(drug_case, 2021, 1)
Violence_21_q2 <- create_violence_ppp(drug_case, 2021, 2)
Violence_21_q3 <- create_violence_ppp(drug_case, 2021, 3)
Violence_21_q4 <- create_violence_ppp(drug_case, 2021, 4)
Violence_22_q1 <- create_violence_ppp(drug_case, 2022, 1)
Violence_22_q2 <- create_violence_ppp(drug_case, 2022, 2)
Violence_22_q3 <- create_violence_ppp(drug_case, 2022, 3)
Violence_22_q4 <- create_violence_ppp(drug_case, 2022, 4)
Violence_23_q1 <- create_violence_ppp(drug_case, 2023, 1)
Violence_23_q2 <- create_violence_ppp(drug_case, 2023, 2)
Violence_23_q3 <- create_violence_ppp(drug_case, 2023, 3)
Violence_23_q4 <- create_violence_ppp(drug_case, 2023, 4)
Violence_24_q1 <- create_violence_ppp(drug_case, 2024, 1)
Violence_24_q2 <- create_violence_ppp(drug_case, 2024, 2)
```

boundary data to the ppp objects.

```{r}
Violence_16_q1_owin = Violence_16_q1[ph_sf_owin]
Violence_16_q2_owin = Violence_16_q2[ph_sf_owin]
Violence_16_q3_owin = Violence_16_q3[ph_sf_owin]
Violence_16_q4_owin = Violence_16_q4[ph_sf_owin]
Violence_17_q1_owin = Violence_17_q1[ph_sf_owin]
Violence_17_q2_owin = Violence_17_q2[ph_sf_owin]
Violence_17_q3_owin = Violence_17_q3[ph_sf_owin]
Violence_17_q4_owin = Violence_17_q4[ph_sf_owin]
Violence_18_q1_owin = Violence_18_q1[ph_sf_owin]
Violence_18_q2_owin = Violence_18_q2[ph_sf_owin]
Violence_18_q3_owin = Violence_18_q3[ph_sf_owin]
Violence_18_q4_owin = Violence_18_q4[ph_sf_owin]
Violence_19_q1_owin = Violence_19_q1[ph_sf_owin]
Violence_19_q2_owin = Violence_19_q2[ph_sf_owin]
Violence_19_q3_owin = Violence_19_q3[ph_sf_owin]
Violence_19_q4_owin = Violence_19_q4[ph_sf_owin]
Violence_20_q1_owin = Violence_20_q1[ph_sf_owin]
Violence_20_q2_owin = Violence_20_q2[ph_sf_owin]
Violence_20_q3_owin = Violence_20_q3[ph_sf_owin]
Violence_20_q4_owin = Violence_20_q4[ph_sf_owin]
Violence_21_q1_owin = Violence_21_q1[ph_sf_owin]
Violence_21_q2_owin = Violence_21_q2[ph_sf_owin]
Violence_21_q3_owin = Violence_21_q3[ph_sf_owin]
Violence_21_q4_owin = Violence_21_q4[ph_sf_owin]
Violence_22_q1_owin = Violence_22_q1[ph_sf_owin]
Violence_22_q2_owin = Violence_22_q2[ph_sf_owin]
Violence_22_q3_owin = Violence_22_q3[ph_sf_owin]
Violence_22_q4_owin = Violence_22_q4[ph_sf_owin]
Violence_23_q1_owin = Violence_23_q1[ph_sf_owin]
Violence_23_q2_owin = Violence_23_q2[ph_sf_owin]
Violence_23_q3_owin = Violence_23_q3[ph_sf_owin]
Violence_23_q4_owin = Violence_23_q4[ph_sf_owin]
Violence_24_q1_owin = Violence_24_q1[ph_sf_owin]
Violence_24_q2_owin = Violence_24_q2[ph_sf_owin]
```

### Strategic_developments

```{r}
create_Strategic_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Strategic developments", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
Strategic_16_q1 <- create_Strategic_ppp(drug_case, 2016, 1)
Strategic_16_q2 <- create_Strategic_ppp(drug_case, 2016, 2)
Strategic_16_q3 <- create_Strategic_ppp(drug_case, 2016, 3)
Strategic_16_q4 <- create_Strategic_ppp(drug_case, 2016, 4)
Strategic_17_q1 <- create_Strategic_ppp(drug_case, 2017, 1)
Strategic_17_q2 <- create_Strategic_ppp(drug_case, 2017, 2)
Strategic_17_q3 <- create_Strategic_ppp(drug_case, 2017, 3)
Strategic_17_q4 <- create_Strategic_ppp(drug_case, 2017, 4)
Strategic_18_q1 <- create_Strategic_ppp(drug_case, 2018, 1)
Strategic_18_q2 <- create_Strategic_ppp(drug_case, 2018, 2)
Strategic_18_q3 <- create_Strategic_ppp(drug_case, 2018, 3)
Strategic_18_q4 <- create_Strategic_ppp(drug_case, 2018, 4)
Strategic_19_q1 <- create_Strategic_ppp(drug_case, 2019, 1)
Strategic_19_q2 <- create_Strategic_ppp(drug_case, 2019, 2)
Strategic_19_q3 <- create_Strategic_ppp(drug_case, 2019, 3)
Strategic_19_q4 <- create_Strategic_ppp(drug_case, 2019, 4)
Strategic_20_q1 <- create_Strategic_ppp(drug_case, 2020, 1)
Strategic_20_q2 <- create_Strategic_ppp(drug_case, 2020, 2)
Strategic_20_q3 <- create_Strategic_ppp(drug_case, 2020, 3)
Strategic_20_q4 <- create_Strategic_ppp(drug_case, 2020, 4)
Strategic_21_q1 <- create_Strategic_ppp(drug_case, 2021, 1)
Strategic_21_q2 <- create_Strategic_ppp(drug_case, 2021, 2)
Strategic_21_q3 <- create_Strategic_ppp(drug_case, 2021, 3)
Strategic_21_q4 <- create_Strategic_ppp(drug_case, 2021, 4)
Strategic_22_q1 <- create_Strategic_ppp(drug_case, 2022, 1)
Strategic_22_q2 <- create_Strategic_ppp(drug_case, 2022, 2)
Strategic_22_q3 <- create_Strategic_ppp(drug_case, 2022, 3)
Strategic_22_q4 <- create_Strategic_ppp(drug_case, 2022, 4)
Strategic_23_q1 <- create_Strategic_ppp(drug_case, 2023, 1)
Strategic_23_q2 <- create_Strategic_ppp(drug_case, 2023, 2)
Strategic_23_q3 <- create_Strategic_ppp(drug_case, 2023, 3)
Strategic_23_q4 <- create_Strategic_ppp(drug_case, 2023, 4)
Strategic_24_q1 <- create_Strategic_ppp(drug_case, 2024, 1)
Strategic_24_q2 <- create_Strategic_ppp(drug_case, 2024, 2)
```

```{r}
Strategic_16_q1_owin = Strategic_16_q1[ph_sf_owin]
Strategic_16_q2_owin = Strategic_16_q2[ph_sf_owin]
Strategic_16_q3_owin = Strategic_16_q3[ph_sf_owin]
Strategic_16_q4_owin = Strategic_16_q4[ph_sf_owin]
Strategic_17_q1_owin = Strategic_17_q1[ph_sf_owin]
Strategic_17_q2_owin = Strategic_17_q2[ph_sf_owin]
Strategic_17_q3_owin = Strategic_17_q3[ph_sf_owin]
Strategic_17_q4_owin = Strategic_17_q4[ph_sf_owin]
Strategic_18_q1_owin = Strategic_18_q1[ph_sf_owin]
Strategic_18_q2_owin = Strategic_18_q2[ph_sf_owin]
Strategic_18_q3_owin = Strategic_18_q3[ph_sf_owin]
Strategic_18_q4_owin = Strategic_18_q4[ph_sf_owin]
Strategic_19_q1_owin = Strategic_19_q1[ph_sf_owin]
Strategic_19_q2_owin = Strategic_19_q2[ph_sf_owin]
Strategic_19_q3_owin = Strategic_19_q3[ph_sf_owin]
Strategic_19_q4_owin = Strategic_19_q4[ph_sf_owin]
Strategic_20_q1_owin = Strategic_20_q1[ph_sf_owin]
Strategic_20_q2_owin = Strategic_20_q2[ph_sf_owin]
Strategic_20_q3_owin = Strategic_20_q3[ph_sf_owin]
Strategic_20_q4_owin = Strategic_20_q4[ph_sf_owin]
Strategic_21_q1_owin = Strategic_21_q1[ph_sf_owin]
Strategic_21_q2_owin = Strategic_21_q2[ph_sf_owin]
Strategic_21_q3_owin = Strategic_21_q3[ph_sf_owin]
Strategic_21_q4_owin = Strategic_21_q4[ph_sf_owin]
Strategic_22_q1_owin = Strategic_22_q1[ph_sf_owin]
Strategic_22_q2_owin = Strategic_22_q2[ph_sf_owin]
Strategic_22_q3_owin = Strategic_22_q3[ph_sf_owin]
Strategic_22_q4_owin = Strategic_22_q4[ph_sf_owin]
Strategic_23_q1_owin = Strategic_23_q1[ph_sf_owin]
Strategic_23_q2_owin = Strategic_23_q2[ph_sf_owin]
Strategic_23_q3_owin = Strategic_23_q3[ph_sf_owin]
Strategic_23_q4_owin = Strategic_23_q4[ph_sf_owin]
Strategic_24_q1_owin = Strategic_24_q1[ph_sf_owin]
Strategic_24_q2_owin = Strategic_24_q2[ph_sf_owin]
```

### Battles

```{r}
create_battles_ppp <- function(data, year, quarter) {
  data %>%
    filter(event_type == "Battles", year == as.character(year), quarter == as.character(quarter)) %>%
    as.ppp()
}
```

```{r}
battles_16_q1 <- create_battles_ppp(drug_case, 2016, 1)
battles_16_q2 <- create_battles_ppp(drug_case, 2016, 2)
battles_16_q3 <- create_battles_ppp(drug_case, 2016, 3)
battles_16_q4 <- create_battles_ppp(drug_case, 2016, 4)
battles_17_q1 <- create_battles_ppp(drug_case, 2017, 1)
battles_17_q2 <- create_battles_ppp(drug_case, 2017, 2)
battles_17_q3 <- create_battles_ppp(drug_case, 2017, 3)
battles_17_q4 <- create_battles_ppp(drug_case, 2017, 4)
battles_18_q1 <- create_battles_ppp(drug_case, 2018, 1)
battles_18_q2 <- create_battles_ppp(drug_case, 2018, 2)
battles_18_q3 <- create_battles_ppp(drug_case, 2018, 3)
battles_18_q4 <- create_battles_ppp(drug_case, 2018, 4)
battles_19_q1 <- create_battles_ppp(drug_case, 2019, 1)
battles_19_q2 <- create_battles_ppp(drug_case, 2019, 2)
battles_19_q3 <- create_battles_ppp(drug_case, 2019, 3)
battles_19_q4 <- create_battles_ppp(drug_case, 2019, 4)
battles_20_q1 <- create_battles_ppp(drug_case, 2020, 1)
battles_20_q2 <- create_battles_ppp(drug_case, 2020, 2)
battles_20_q3 <- create_battles_ppp(drug_case, 2020, 3)
battles_20_q4 <- create_battles_ppp(drug_case, 2020, 4)
battles_21_q1 <- create_battles_ppp(drug_case, 2021, 1)
battles_21_q2 <- create_battles_ppp(drug_case, 2021, 2)
battles_21_q3 <- create_battles_ppp(drug_case, 2021, 3)
battles_21_q4 <- create_battles_ppp(drug_case, 2021, 4)
battles_22_q1 <- create_battles_ppp(drug_case, 2022, 1)
battles_22_q2 <- create_battles_ppp(drug_case, 2022, 2)
battles_22_q3 <- create_battles_ppp(drug_case, 2022, 3)
battles_22_q4 <- create_battles_ppp(drug_case, 2022, 4)
battles_23_q1 <- create_battles_ppp(drug_case, 2023, 1)
battles_23_q2 <- create_battles_ppp(drug_case, 2023, 2)
battles_23_q3 <- create_battles_ppp(drug_case, 2023, 3)
battles_23_q4 <- create_battles_ppp(drug_case, 2023, 4)
battles_24_q1 <- create_battles_ppp(drug_case, 2024, 1)
battles_24_q2 <- create_battles_ppp(drug_case, 2024, 2)
```

```{r}
battles_16_q1_owin = battles_16_q1[ph_sf_owin]
battles_16_q2_owin = battles_16_q2[ph_sf_owin]
battles_16_q3_owin = battles_16_q3[ph_sf_owin]
battles_16_q4_owin = battles_16_q4[ph_sf_owin]
battles_17_q1_owin = battles_17_q1[ph_sf_owin]
battles_17_q2_owin = battles_17_q2[ph_sf_owin]
battles_17_q3_owin = battles_17_q3[ph_sf_owin]
battles_17_q4_owin = battles_17_q4[ph_sf_owin]
battles_18_q1_owin = battles_18_q1[ph_sf_owin]
battles_18_q2_owin = battles_18_q2[ph_sf_owin]
battles_18_q3_owin = battles_18_q3[ph_sf_owin]
battles_18_q4_owin = battles_18_q4[ph_sf_owin]
battles_19_q1_owin = battles_19_q1[ph_sf_owin]
battles_19_q2_owin = battles_19_q2[ph_sf_owin]
battles_19_q3_owin = battles_19_q3[ph_sf_owin]
battles_19_q4_owin = battles_19_q4[ph_sf_owin]
battles_20_q1_owin = battles_20_q1[ph_sf_owin]
battles_20_q2_owin = battles_20_q2[ph_sf_owin]
battles_20_q3_owin = battles_20_q3[ph_sf_owin]
battles_20_q4_owin = battles_20_q4[ph_sf_owin]
battles_21_q1_owin = battles_21_q1[ph_sf_owin]
battles_21_q2_owin = battles_21_q2[ph_sf_owin]
battles_21_q3_owin = battles_21_q3[ph_sf_owin]
battles_21_q4_owin = battles_21_q4[ph_sf_owin]
battles_22_q1_owin = battles_22_q1[ph_sf_owin]
battles_22_q2_owin = battles_22_q2[ph_sf_owin]
battles_22_q3_owin = battles_22_q3[ph_sf_owin]
battles_22_q4_owin = battles_22_q4[ph_sf_owin]
battles_23_q1_owin = battles_23_q1[ph_sf_owin]
battles_23_q2_owin = battles_23_q2[ph_sf_owin]
battles_23_q3_owin = battles_23_q3[ph_sf_owin]
battles_23_q4_owin = battles_23_q4[ph_sf_owin]
battles_24_q1_owin = battles_24_q1[ph_sf_owin]
battles_24_q2_owin = battles_24_q2[ph_sf_owin]
```

```{r}
Violence_against_civilians_16_q2.csr = envelope(Violence_against_civilians_16_q2_owin, Gest, nsim = 99)
Violence_against_civilians_16_q3.csr = envelope(Violence_against_civilians_16_q3_owin, Gest, nsim = 99)
Violence_against_civilians_16_q4.csr = envelope(Violence_against_civilians_16_q4_owin, Gest, nsim = 99)
Violence_against_civilians_17_q1.csr = envelope(Violence_against_civilians_17_q1_owin, Gest, nsim = 99)
Violence_against_civilians_17_q2.csr = envelope(Violence_against_civilians_17_q2_owin, Gest, nsim = 99)
Violence_against_civilians_17_q3.csr = envelope(Violence_against_civilians_17_q3_owin, Gest, nsim = 99)
Violence_against_civilians_17_q4.csr = envelope(Violence_against_civilians_17_q4_owin, Gest, nsim = 99)
Violence_against_civilians_21_q2.csr = envelope(Violence_against_civilians_21_q2_owin, Gest, nsim = 99)
Violence_against_civilians_21_q3.csr = envelope(Violence_against_civilians_21_q3_owin, Gest, nsim = 99)
```

```{r}
plot(Violence_against_civilians_16_q2.csr)
```

```{r}
par(mfrow = c(3,3))
plot(Violence_against_civilians_16_q2.csr)
plot(Violence_against_civilians_16_q3.csr)
plot(Violence_against_civilians_16_q4.csr)
plot(Violence_against_civilians_17_q1.csr)
plot(Violence_against_civilians_17_q2.csr)
plot(Violence_against_civilians_17_q3.csr)
plot(Violence_against_civilians_17_q4.csr)
plot(Violence_against_civilians_21_q2.csr)
plot(Violence_against_civilians_21_q3.csr)
```
